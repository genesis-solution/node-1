import{a0 as V,q as X,r as x,I as H,l as e,ab as Z,n as l,L as ee,F as N,ac as c,ad as n,k as y,Q as M}from"./index-7VV-N64s.js";import{A as le,a as q}from"./index.esm-BGPpp3J5.js";import{S as ae}from"./index-BJg3HNK-.js";import{u as te}from"./useTaxes-BPe3uPZj.js";import{u as se}from"./useUserDetails-DGu4Y-yt.js";const ie={items:"Room price",itemsPrice:743,priceDrop:"Price Drop",priceDropAmount:229,coupon:"42% Coupon Discount",couponAmount:216};function pe(){var E,$,P,R,j,O,W,z,I,T,U;const{data:t}=se(),{auth:s}=V(),v=X(),{startDate:Q,endDate:oe,startTime:d,endTime:m,guests:w}=v.state??{},a=v.state.spot;console.log("checkout",{spot:a}),console.log("ST",d),console.log("ET",m);const[g,k]=x.useState(null),[h,C]=x.useState(),[b,S]=x.useState(),{data:Y}=te({state:a.location.state,city:a.location.city}),o=Y[0]??{taxRate:0,serviceFee:0},A=a._id,F=H(m).diff(H(d),"minute")/60,u=(b==null?void 0:b.saves)??0,r=(a==null?void 0:a.price)*Math.ceil(F)-u;console.log("[NO OF HOURS]",F);const L=async()=>{if(k(null),!h)return S(null);try{const i=await y.post("/discount/validation",{code:h,product:A,amount:r+u});console.log(i.data),S(i.data),M.success("Coupon Applied")}catch{k("Invalid Coupon")}},D=async i=>{var _,B;i.preventDefault();try{const p={products:[{product:A,guests:w??1}],rent:{start:d,end:m},discount:h||void 0},G=await y.post("/checkout",p,{maxRedirects:0});console.log(G.data),window.location=G.data}catch(p){console.error(p),M.error(((B=(_=p==null?void 0:p.response)==null?void 0:_.data)==null?void 0:B.message)??"Something went wrong!")}};function J(...i){return i.filter(Boolean).join(" ")}const[f,K]=x.useState(window.innerWidth);return window.addEventListener("resize",()=>{K(window.innerWidth),console.log(f)}),x.useEffect(()=>{console.log(f),window.removeEventListener("resize",()=>{console.log("removed event listener")})},[f]),v.state?e(N,{children:l("div",{className:"items-center p-2 pb-8 space-y-4 lg:space-y-0 lg:p-12 flex-col w-[100%]",children:[l("div",{className:"flex flex-row space-x-2 pt-4 text-blue-600 font-bold self-start",children:[e(le,{className:"m-1"}),e(ee,{to:-1,children:"Modify your booking"})]}),l("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(18rem,1fr))]  ",children:[f>600?e(N,{children:l("div",{className:"w-full p-4 mx-auto flex flex-col gap-y-3",children:[l("div",{className:"flex items-center",children:[e(q,{className:"m-1"}),e("h1",{className:"text-xl font-bold",children:"Enter your details"})]}),e("p",{className:"text-gray-600",children:"We will use these detail s to share your booking information"}),l("form",{onSubmit:D,className:"grid grid-cols-1 sm:grid-cols-2 w-full gap-2",children:[l("div",{className:"",children:[e(c,{children:"First Name"}),e(n,{type:"text",placeholder:"",value:(t==null?void 0:t.firstName)??(($=(E=s==null?void 0:s.name)==null?void 0:E.split(" "))==null?void 0:$[0])})]}),l("div",{className:"",children:[e(c,{children:"Last Name"}),e(n,{type:"text",value:(t==null?void 0:t.lastName)??((j=(R=(P=s==null?void 0:s.name)==null?void 0:P.split(" "))==null?void 0:R.slice(1))==null?void 0:j.join(" "))})]}),l("div",{className:"",children:[e(c,{children:"Email Address"}),e(n,{type:"email",value:s==null?void 0:s.email})]}),l("div",{className:"",children:[e(c,{children:"Phone Number"}),e(n,{type:"tel",value:t==null?void 0:t.phone})]}),l("div",{className:"sm:col-span-2",children:[e(c,{children:"Coupon Code"}),l("div",{className:"flex items-center relative ",children:[e(n,{value:h,onChange:i=>C(i.target.value),type:"text",placeholder:"Any Coupon Code",fullwidth:!0}),e("button",{type:"button",onClick:L,className:"font-medium text-[#24b124] absolute z-20 right-5 top-2 cursor-pointer",children:"Apply"})]})]}),g&&e("p",{className:"text-red-500",children:g}),e("button",{type:"submit",className:"sm:col-span-2 p-4 bg-brand-primary text-black hover:text-white font-bold rounded-lg hover:bg-black",children:"Pay Now"}),e("ul",{className:"sm:col-span-2 list-disc list-inside",children:e("li",{children:"by clicking pay now to accept to all our terms & conditions"})})]})]})}):e(N,{}),l("div",{className:"flex flex-col space-y-6 p-6 border rounded-lg",children:[l("div",{className:"flex flex-row justify-between",children:[l("div",{className:"space-y-2",children:[e("h1",{className:"font-bold text-lg",children:a==null?void 0:a.name}),e("p",{className:"text-sm",children:a.location.address}),e("div",{className:"flex flex-row",children:e("div",{className:"flex items-center",children:[0,1,2,3,4].map(i=>e(ae,{className:J(a.average_rating>i?"text-gray-900":"text-gray-200","h-4 w-4 flex-shrink-0"),"aria-hidden":"true"},i))})})]}),e("div",{children:e("img",{className:"w-32 rounded-lg drop-shadow-md",src:`${y.defaults.baseURL}/product/images/${a==null?void 0:a._id}/${(O=a==null?void 0:a.images)==null?void 0:O[0]}`,alt:"spot"})})]}),l("div",{className:"flex flex-col space-y-3",children:[l("ul",{className:"flex flex-col space-y-3 border-0 border-b-2 border-gray-400",children:[l("li",{className:"flex flex-row",children:[e("p",{children:"Dates of Booking"}),l("p",{className:"ml-auto",children:[new Date(Q).toDateString(),","," ",d==null?void 0:d.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," ","-"," ",m==null?void 0:m.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),l("li",{className:"flex flex-row",children:[e("p",{children:"Guest Count"}),l("p",{className:"ml-auto",children:[w," Guests"]})]}),l("li",{className:"flex flex-row",children:[e("p",{children:ie.items}),e("p",{className:"ml-auto",children:`$ ${(r+u).toFixed(2)}`})]}),l("li",{className:"flex flex-row pb-0",children:[l("p",{children:["Tax (",o==null?void 0:o.taxRate,"%)"]}),l("p",{className:"ml-auto",children:["$ ",(r*(o.taxRate/100)).toFixed(2)]})]}),l("li",{className:"flex flex-row",children:[l("p",{children:["Service Fee (",o.serviceFee,"%)"]}),l("p",{className:"ml-auto",children:["$ ",(r*((o==null?void 0:o.serviceFee)/100)).toFixed(2)]})]}),u!=0&&l("li",{className:"flex flex-row pb-4",children:[e("p",{children:"You saved ( amount )"}),l("p",{className:"ml-auto",children:["-$ ",u]})]})]}),l("div",{className:"flex items-end",children:[l("ul",{children:[e("li",{className:"flex flex-row font-semibold text-md",children:"Payable Amount"}),e("li",{className:"text-xs",children:"* inclusive of all taxes"})]}),e("p",{className:"ml-auto mt-2 font-black text-lg",children:`$ ${(r+r*o.taxRate/100+r*o.serviceFee/100).toFixed(2)}`})]})]})]}),f<600?e(N,{children:l("div",{className:"w-full p-4 mx-auto flex flex-col gap-y-3",children:[l("div",{className:"flex items-center",children:[e(q,{className:"m-1"}),e("h1",{className:"text-xl font-bold",children:"Enter your details"})]}),e("p",{className:"text-gray-600",children:"We will use these detail s to share your booking information"}),l("form",{onSubmit:D,className:"grid grid-cols-1 sm:grid-cols-2 w-full gap-2",children:[l("div",{className:"",children:[e(c,{children:"First Name"}),e(n,{type:"text",placeholder:"",value:(t==null?void 0:t.firstName)??((z=(W=s==null?void 0:s.name)==null?void 0:W.split(" "))==null?void 0:z[0])})]}),l("div",{className:"",children:[e(c,{children:"Last Name"}),e(n,{type:"text",value:(t==null?void 0:t.lastName)??((U=(T=(I=s==null?void 0:s.name)==null?void 0:I.split(" "))==null?void 0:T.slice(1))==null?void 0:U.join(" "))})]}),l("div",{className:"",children:[e(c,{children:"Email Address"}),e(n,{type:"email",value:s==null?void 0:s.email})]}),l("div",{className:"",children:[e(c,{children:"Phone Number"}),e(n,{type:"tel",value:t==null?void 0:t.phone})]}),l("div",{className:"sm:col-span-2",children:[e(c,{children:"Coupon Code"}),l("div",{className:"flex items-center relative ",children:[e(n,{value:h,onChange:i=>C(i.target.value),type:"text",placeholder:"Any Coupon Code",fullwidth:!0}),e("button",{type:"button",onClick:L,className:"font-medium text-[#24b124] absolute z-20 right-5 top-2 cursor-pointer",children:"Apply"})]})]}),g&&e("p",{className:"text-red-500",children:g}),e("button",{type:"submit",className:"sm:col-span-2 p-4 bg-brand-primary text-black hover:text-white font-bold rounded-lg hover:bg-black",children:"Pay Now"}),e("ul",{className:"sm:col-span-2 list-disc list-inside",children:e("li",{children:"by clicking pay now to accept to all our terms & conditions"})})]})]})}):e(N,{})]})]})}):e(Z,{to:`/spot/${a==null?void 0:a.id}`})}export{pe as default};
