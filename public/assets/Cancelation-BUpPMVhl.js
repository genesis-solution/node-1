import{w as x,r as o,a0 as F,n as t,l as e,ac as m,S,ad as k,Q as q,k as R,a9 as j,bG as E,dg as O}from"./index-7VV-N64s.js";import{C as I}from"./CancellationPolicies-BHFJqqI1.js";import{u as B}from"./useBooking-BmA3KNKF.js";import{u as A,d as _}from"./useCancelation-BDKy-5q2.js";const L=["Change in plans","Sudden travel restrictions","Booking error","Unforeseen circumstances","Health concerns","Weather-related issues","Venue availability changed","Event cancellation","Personal emergencies","Found a better option","Other"];function D(){const[s,i]=o.useState(""),[c,u]=o.useState(""),[p,d]=o.useState(""),[y,f]=o.useState(!1),{data:b}=B(),{auth:r}=F(),v=r==null?void 0:r.name,a=r==null?void 0:r.email;return t("form",{className:"flex flex-col gap-4 w-full",onSubmit:async n=>{n.preventDefault(),console.log({order:s,reason:c,other:p,acknowledgement:y}),await q.promise(R.post("/cancelation",{order:s,reason:p||c}),{pending:"Sending request...",success:"Request sent successfully",error:{render({data:l}){var h,g,w;return((h=l==null?void 0:l.response)==null?void 0:h.status)===409?"Request already sent":((w=(g=l==null?void 0:l.response)==null?void 0:g.data)==null?void 0:w.message)||"Failed to send request"}}})},onReset:()=>{i(""),u(""),d(""),f(!1)},children:[t("div",{className:"flex flex-col",children:[e(m,{htmlFor:"order",children:"Booking ID"}),t(S,{type:"text",id:"order",name:"order",value:s,onChange:n=>i(n.target.value),margin:!0,required:!0,children:[e("option",{value:"",children:"Select a booking"}),b.map((n,l)=>e("option",{value:n._id,children:n.id},l))]})]}),t("div",{className:"flex flex-col",children:[e(m,{htmlFor:"name",children:"Name"}),e(k,{type:"text",id:"name",name:"name",value:v,margin:!0,disabled:!0})]}),t("div",{className:"flex flex-col",children:[e(m,{htmlFor:"email",children:"Email"}),e(k,{type:"email",id:"email",name:"email",value:a,margin:!0,disabled:!0})]}),t("div",{className:"flex flex-col",children:[e(m,{htmlFor:"reason",children:"Reason for Cancellation"}),t(S,{id:"reason",name:"reason",value:c,onChange:n=>{u(n.target.value),d("")},margin:!0,required:!0,children:[e("option",{value:"",children:"Select a reason"}),L.map((n,l)=>e("option",{value:n,children:n},l))]})]}),c==="Other"&&t("div",{className:"flex flex-col",children:[e(m,{htmlFor:"other",children:"Other Reason"}),e(k,{type:"text",id:"other",name:"other",value:p,onChange:n=>d(n.target.value),margin:!0,required:!0})]}),t("div",{className:"flex flex-row gap-3 items-center",children:[e("input",{type:"checkbox",id:"acknowledgement",name:"acknowledgement",checked:y,onChange:n=>f(n.target.checked),className:"",required:!0}),e(m,{htmlFor:"acknowledgement",children:"I acknowledge the cancellation policy"})]}),e(I,{}),t("div",{className:"-mx-5 -mb-5 bg-[#F3F3F3] flex font-medium gap-3 px-4 py-2",children:[e("button",{className:"bg-brand-primary text-black py-1.5 px-3 rounded-md",type:"submit",children:"Submit"}),e("button",{className:"bg-transparent  border-[#696C80] border-2  text-[#696C80] px-3 py-2 rounded-md",type:"reset",children:"Cancel"})]})]})}D.propTypes={orders:x.arrayOf(x.string).isRequired,onCancel:x.func.isRequired,name:x.string,email:x.string};function G(){return e(E,{title:"Cancellation",children:e(j,{navs:[{name:"Cancellation",view:"support",component:()=>e(D,{})},{name:"Cancellation Status",view:"status",component:()=>e(P,{})}]})})}const P=()=>{var b,r,v;const s=A();console.log("Cancelation Data:",(r=(b=s.data[0])==null?void 0:b.order)==null?void 0:r.products[0]._id);const[i,c]=o.useState(null),[u,p]=o.useState(!1),[d,y]=o.useState(null),f=a=>{c(i===a?null:a)};return t("div",{className:"flex flex-wrap max-sm:mb-16 max-sm:mb-10 w-full duration-200 gap-4 px-1 ",children:[(v=s.data)==null?void 0:v.map(a=>{var N,C,n,l,h,g;return t("div",{className:`flex flex-col items-center border-2 border-zinc-300 max-sm:w-full duration-200 justify-between p-4 bg-white rounded-lg shadow-md md:w-full ${i===a.id?"h-auto":"h-34"}`,children:[t("div",{className:"flex w-full justify-between items-start",children:[t("div",{className:"flex items-start flex-col gap-4",children:[t("div",{className:"bg-brand-primary text-black rounded-full flex justify-start items-start px-3 py-1 text-sm font-bold ",children:[e("span",{children:"#"})," ",e("span",{children:a.id})]}),t("div",{children:[t("h2",{className:"text-lg font-semibold",children:["Booking ID: ",(N=a.order)==null?void 0:N.id]}),t("p",{className:"text-sm text-gray-600",children:["Cancelation ID: ",a.id]})]})]}),t("div",{className:"flex flex-col items-center justify-center bg-brand-primary rounded-lg w-24 h-24 text-black",children:[e("p",{className:"text-4xl font-['fjord-one-regular']",children:new Date((C=a.order)==null?void 0:C.rent.start).getDate()}),e("p",{className:"text-sm",children:new Date((n=a.order)==null?void 0:n.rent.start).toLocaleString("default",{month:"long"})}),e("p",{className:"text-sm",children:new Date((l=a.order)==null?void 0:l.rent.start).getFullYear()})]})]}),i===a.id&&t("div",{className:"mt-4 w-full",children:[t("p",{className:"text-sm text-gray-600",children:[e("span",{className:"font-bold",children:"Spot ID:"})," ",((h=a.order)==null?void 0:h.products[0]._id)||"N/A"]}),t("p",{className:"text-sm text-gray-600",children:[e("span",{className:"font-bold",children:"Booking Date:"})," ",new Date((g=a.order)==null?void 0:g.createdAt).toLocaleDateString()]}),t("div",{className:"flex hidden justify-end gap-2 mt-4",children:[e("button",{className:"bg-blue-500 text-white px-4 py-2 rounded-lg",onClick:()=>_(a._id),children:"Edit"}),e("button",{className:"bg-red-500 text-white px-4 py-2 rounded-lg",children:"Cancel"})]})]}),e(O,{onClick:()=>f(a.id),className:`text-gray-500 cursor-pointer duration-500 w-16 h-6 mt-2 ${i===a.id?"rotate-180":"rotate-0"}`})]},a.id)}),u&&d&&e("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:e("div",{className:"bg-white p-8 rounded-lg shadow-lg max-w-lg w-full",children:e(CancelationDetails,{open:u,onClose:()=>p(!1),cancelation:d,refetch:s.query.refetch})})})]})};export{G as default};
