import{E as x,H as C,j as F,w as d,b5 as N,l as n,aF as j,bm as _,r as m,n as f,aA as u,da as D,bp as I,bq as R,k as A,Q as v,bo as M,F as S}from"./index-7VV-N64s.js";import{d as k}from"./Approval-P1nl9vXc.js";import{d as $}from"./KeyboardArrowDown-3G4cmplF.js";import{u as q}from"./useCancelation-BDKy-5q2.js";var p={},E=C;Object.defineProperty(p,"__esModule",{value:!0});var h=p.default=void 0,T=E(x()),V=F,z=(0,T.default)((0,V.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"}),"Visibility");h=p.default=z;function g({handleApprove:t,disabled:l,data:i}){const c=N();return n(_,{menu:{items:[{key:"1",label:"Approve",icon:n(k,{}),onClick:t,disabled:l},{key:"2",label:"View",icon:n(h,{}),onClick:()=>{c(`/admin/listing-management?${i.order.products[0].product._id}`)},disabled:!i.order.products[0].product,title:"View Listing"}]},children:n(j,{disabled:l,variant:"contained",color:"primary",size:"small",endIcon:n($,{}),children:"Actions"})})}g.propTypes={id:d.string,toggleView:d.func,data:d.object};const y=()=>{const[t,l]=m.useState({}),i=q(),c=m.useMemo(()=>[{id:"order.id",header:"Booking ID",accessorFn:e=>`BK${e.order.id}`},{id:"id",header:"Cancellation ID",accessorFn:e=>e.id},{id:"order.user.name",header:"Guest",accessorFn:e=>{var r,a;return(a=(r=e.order)==null?void 0:r.user)==null?void 0:a.name}},{id:"order.user.id",header:"Guest ID",accessorFn:e=>{var r,a;return((a=(r=e==null?void 0:e.order)==null?void 0:r.user)==null?void 0:a.id)??"N/A"}},{id:"order.id",header:"Spot",accessorFn:e=>{var r;return(r=e.order)==null?void 0:r.id}},{id:"order.products.owner.name",header:"Host Name",accessorFn:e=>{var r,a,o;return`${(o=(a=(r=e.order)==null?void 0:r.products)==null?void 0:a.map(s=>s.owner.name))==null?void 0:o.join(", ")}`}},{id:"order.products.owner.id",header:"Host ID",accessorFn:e=>{var r,a,o;return(o=(a=(r=e.order)==null?void 0:r.products)==null?void 0:a.map(s=>s.owner.id))==null?void 0:o.join(", ")}},{id:"order.products.owner.email",header:"Host Email",accessorFn:e=>{var r,a,o;return(o=(a=(r=e.order)==null?void 0:r.products)==null?void 0:a.map(s=>s.owner.email))==null?void 0:o.join(", ")}},{id:"reason",header:"Reason",accessorFn:e=>e.reason},{id:"policy",header:"Refund",accessorFn:e=>e.policy,Cell:({renderedCellValue:e,row:r})=>{const a=r.original._id,o=r.original.policy;return f(D,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:t[a]||e||"No refund",label:"Refund",onChange:s=>{l({...t,[a]:s.target.value})},disabled:o,children:[n(u,{value:"Full refund",children:"100% refund"}),n(u,{value:"Partial refund",children:"50% refund"}),n(u,{value:"No refund",children:"No refund"})]})}},{id:"approved",header:"Status",Cell:({row:e})=>{const r=e.original.policy||e.original.approved;return f("div",{className:"flex items-center gap-2",children:[n("div",{className:"rounded-full text-xl",children:r?n(I,{className:"text-green-500"}):r===!1?n(R,{className:"text-red-500"}):null}),n("p",{className:"text-sm font-bold text-navy-700 ",children:r===!1?"Pending":r==="No refund"?"Rejected":"Approved"})]})}},{id:"actions",header:"Actions",Cell:({row:e})=>n(g,{data:e.original,disabled:(e==null?void 0:e.original.approved)===!0||e.original.policy,handleApprove:()=>b(e.original._id)})}],[t]),b=async(e,r)=>{const a=t[e]||"No refund",o=a==="No refund"?"reject":"approve";try{await A.post(`/cancelation/${o}/${e}`,{policy:a}),v.success("Cancellation approved successfully"),i.query.refetch()}catch(s){console.log(s),v.error("Oops! something went wrong")}};return n(S,{children:n(M,{columns:c,...i})})};y.propTypes={tableName:d.string,columnsData:d.any};function G(){return n("div",{children:n(y,{})})}export{G as default};
