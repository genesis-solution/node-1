import{r as s,l as e,Q as x,k as S,n as l,L as R,x as I,bG as M,F as y,w as T,a4 as $}from"./index-7VV-N64s.js";import"./swiper-DPGn5qAn.js";import{u as C}from"./useDraftSpot-C54CnDr5.js";import{S as V}from"./Spot-BQhcZjWC.js";import{S as P,u as _}from"./useDeleteSpot-AZtbUA7r.js";import{r as j}from"./index-CsrS5TK7.js";import{u as A}from"./useSpots-DI3uYDAz.js";import{RatingsSummary as B}from"./ReviewManagement-BYIaTX7j.js";import"./ChangeView-CDkdWtqO.js";import"./MapEvents-DoU__i7w.js";import"./useAmenities-ByFBqxGF.js";import"./useCategories-CVIE_Zfq.js";import"./useCityAndStates-BqyloICP.js";import"./BetterTimePicker-iUuzyWXw.js";import"./index-BJg3HNK-.js";import"./transition-Crwx9Jvs.js";import"./SpotCard-D1bckGnm.js";import"./useReviews-y2EBonKG.js";function O(){const{spotRef:t,spot:n,updateSpot:i}=C(),o=j.useAsyncDebounce(i,1500),[r,m]=s.useState(!1),p=()=>{setTimeout(()=>{window.location.href="/host/property-management"},3e3)};return e(P,{initial:n,spotRef:t,onChange:u=>{t.current={...t.current,...u},console.log(t.current),o({...t.current,...u,draft:!0})},onSave:async u=>{if(!r){m(!0);try{await x.promise(o({...u,draft:!1},{onSuccess:p,onError:d=>{var f;d instanceof S.AxiosError?x.error(((f=d==null?void 0:d.response)==null?void 0:f.data.message)||"Failed to save spot"):x.error("Failed to save spot")}}),{success:"Spot saved successfully",pending:"Saving Spot..."})}finally{m(!1)}}},disabled:r})}function F({spot:t}){const n=s.useRef(t),{updateSpot:i}=C(),[o,r]=s.useState(!1),m=async c=>{if(!o){r(!0);try{x.promise(i({...n.current},{onError:a=>{var u,d;return console.log(a instanceof S.AxiosError),console.log((u=a==null?void 0:a.response)==null?void 0:u.data.message),x.error(((d=a==null?void 0:a.response)==null?void 0:d.data.message)||"Failed to update spot")}}),{pending:"Updating spot...",success:"Spot updated successfully"})}finally{r(!1)}}},p=c=>{console.log(c),n.current={...n.current,...c}};return s.useEffect(()=>{n.current=t},[t]),e(P,{initial:t,spotRef:n,onChange:p,onSave:m,disabled:o})}F.propTypes={spot:V.isRequired};const Z=({spot:t,setEditSpot:n,setseleteddataforpriceupdate:i,setselectedspotforreview:o})=>{var p,c;const[r,m]=s.useState(!1);return l("div",{className:"border border-black min-h-[30vh] rounded-2xl px-3 py-2 h-fit",children:[l("div",{className:"h-[10vh] border-b border-black flex flex-col md:flex-row items-start md:items-center gap-3",children:[l("div",{className:"w-full md:w-[75%] flex flex-col md:flex-row items-start md:items-center justify-between gap-2",children:[l("div",{children:[e("h1",{className:"text-sm font-semibold",children:"Spot Listed On"}),e("p",{className:"text-xs",children:new Date(t.createdAt).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"})})]}),l("div",{children:[e("h1",{className:"text-sm font-semibold",children:"Views"}),e("p",{className:"text-xs",children:t.views})]}),l("div",{children:[e("h1",{className:"text-sm font-semibold",children:"Number Of Guests"}),e("p",{className:"text-xs",children:t.maxCapacity})]}),l("div",{children:[e("h1",{className:"text-sm font-semibold",children:"Number Of Bookings"}),e("p",{className:"text-xs",children:"123"})]}),l("div",{className:"text-center",children:[e("h1",{className:"text-sm font-semibold",children:"Experience"}),l("div",{className:"text-xs flex items-center",children:[e("svg",{width:"13",height:"12",viewBox:"0 0 13 12",className:"mr-2",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e("path",{d:"M6.5 0L7.95934 4.49139H12.6819L8.86126 7.26722L10.3206 11.7586L6.5 8.98278L2.6794 11.7586L4.13874 7.26722L0.318133 4.49139H5.04066L6.5 0Z",fill:"#3BD9FF"})}),t.average_rating," ",l("span",{className:"text-[8px] flex items-end ml-1",children:["(",t.review_count," reviews)"]})]})]}),l("div",{children:[e("h1",{className:"text-sm font-semibold",children:"Status"}),e("p",{className:"text-xs",children:t.approved?"Approved":"Pending"})]})]}),l("div",{className:"w-full md:w-[25%] flex items-center justify-center relative",children:[l("h1",{className:"font-semibold",children:["Spot ID: ",t.id]}),e(R,{className:"absolute -top-4 right-0",to:`/spot/${t.id}?view=Overview`,children:e("svg",{width:"18",height:"15",viewBox:"0 0 18 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e("path",{d:"M18 7L11 0V4C4 5 1 10 0 15C2.5 11.5 6 9.9 11 9.9V14L18 7Z",fill:"black"})})})]})]}),l("div",{className:"min-h-[20vh] flex flex-col md:flex-row h-fit mt-3 gap-3",children:[l("div",{className:"w-full md:w-[78%] flex flex-col md:flex-row gap-3",children:[e("div",{className:"md:w-[160px] w-full h-[160px] overflow-hidden rounded-lg",children:e("img",{src:`${S.defaults.baseURL}/product/images/${t._id}/${t.images[0]}`,alt:t.images[0],className:"w-full object-cover h-full"})}),l("div",{className:"flex-1 flex flex-col",children:[l("p",{className:"text-xs text-zinc-800",children:[(p=t.location)==null?void 0:p.state,", ",(c=t.location)==null?void 0:c.country]}),l("p",{className:"text-xs lg:text-sm mt-2 overflow-hidden break-words w-full md:w-[500px]",children:[r?t.description:`${t.description.substring(0,200)}...`,e("button",{onClick:()=>m(!r),className:"text-blue-500 font-semibold ml-1",children:r?"Show Less":"Show More"})]})]})]}),l("div",{className:"w-full md:w-[22%] flex flex-col items-center justify-between gap-2",children:[e("button",{onClick:()=>n(t),className:"w-full h-fit text-sm border py-1 border-black rounded-full",children:"Edit your Spot"}),e("button",{onClick:()=>i(t),className:"w-full h-fit text-sm border py-1 border-black rounded-full",children:"Adjust Price"}),e("button",{onClick:()=>o(t),className:"w-full h-fit text-sm border py-1 border-black rounded-full",children:"View Experiences"})]})]})]})};function U({spot:t,setselectedSpot:n,selectedspot:i,selectedspotid:o,setselectedspotid:r,seleteddataforpriceupdate:m}){const[p,c]=s.useState(!1);I();const[a,u]=s.useState(),[d,f]=s.useState("SPT"),[w,L]=s.useState();return s.useEffect(()=>{t&&L(t.filter(h=>h._id==m._id))},[m,t]),s.useEffect(()=>{u(w)},[t]),s.useEffect(()=>{u(w)},[t]),s.useEffect(()=>{a&&a.length===1&&(r(a[0]),n(a[0].id),c(!1),f(""))},[a,n,r]),l("div",{className:"md:w-full px-3 bg-transparent rounded-2xl p-2 w-full",children:[p?e("div",{children:e("input",{type:"text",className:"appearance-none bg-zinc-300 block w-full text-lg text-start border-none h-fit py-2 text-zinc-500 rounded-lg px-4 font-main font-semibold outline-none focus:ring-0",placeholder:"Search Spot",value:d,onChange:h=>{const b=h.target.value.toLowerCase();f(b);const v=t.filter(N=>N.id.toLowerCase().includes(b));u(v)}})}):e("button",{className:"appearance-none bg-zinc-300 block w-full text-lg text-start border-none h-fit py-2 text-zinc-500 rounded-lg px-4 font-main font-semibold outline-none",onClick:()=>c(!0),children:i?`#${o.id}`:"Select Spot"}),p&&e("div",{className:"max-h-[70vh] h-fit absolute overflow-auto border rounded-lg mt-2 w-[200px]",children:e("ul",{className:"bg-white text-black overflow-hidden",children:a&&a.length>0?a.map((h,b)=>e("li",{className:"py-1 px-2 hover:bg-brand-primary hover:text-black duration-200 cursor-pointer",onClick:()=>{c(!1),r(h),n(h.id),f("")},children:h.id},b)):e("li",{className:"py-1 px-2 duration-200 cursor-pointer",children:"No spots found"})})})]})}const q=({setseleteddataforpriceupdate:t,seleteddataforpriceupdate:n})=>{const[i,o]=s.useState(),{spotRef:r,updateSpot:m}=C(),p=j.useAsyncDebounce(m,1500),{spots:c,isLoading:a}=A({draft:!1});s.useEffect(()=>{o(c)},[c]);const[u,d]=s.useState(null),[f,w]=s.useState(""),[L,k]=s.useState(""),[h,b]=s.useState(""),[v,N]=s.useState(!1);s.useEffect(()=>{f&&(r.current=f,k(f.price),console.log(f))},[f]);const D=async()=>{if(!h||h<=0){x.warning("Please enter a valid price.");return}N(!0);try{r.current={...r.current,price:h},await x.promise(p({...r.current},{onError:g=>{var E;g instanceof S.AxiosError?x.error(((E=g==null?void 0:g.response)==null?void 0:E.data.message)||"Failed to update price."):x.error("Failed to update price.")}}),{pending:"Updating price...",success:"Price updated successfully!"}),k(h)}catch{x.error("Failed to update the price.")}finally{N(!1)}};return e("div",{className:"w-screen h-screen fixed bg-white/5 backdrop-blur-2xl z-[9999] top-0 left-0 flex items-center justify-center",children:l("div",{className:"flex justify-center  z-[999]  rounded-2xl items-center h-fit scale-75 relative w-fit",children:[e("button",{onClick:()=>t(null),className:"absolute right-10 top-10",children:e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",fill:"currentColor",children:e("path",{d:"M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 10.5858L9.17157 7.75736L7.75736 9.17157L10.5858 12L7.75736 14.8284L9.17157 16.2426L12 13.4142L14.8284 16.2426L16.2426 14.8284L13.4142 12L16.2426 9.17157L14.8284 7.75736L12 10.5858Z"})})}),l("div",{className:"bg-white rounded-2xl shadow-lg p-8 flex flex-col w-full max-w-4xl",children:[e("div",{className:"flex justify-center items-center w-full",children:e("h2",{className:"text-xl font-bold mb-6 text-center bg-brand-primary px-4 py-2 rounded-xl",children:"Thinking about adjusting your price?"})}),l("div",{className:"flex gap-4",children:[e("div",{className:"w-[46%] pr-10 border-r-2 border-zinc-300 flex items-center justify-start",children:l("form",{className:"space-y-4",children:[l("div",{children:[e("label",{htmlFor:"spot",className:"text-black px-4",children:"Select Spot"}),e(U,{spot:i==null?void 0:i.map(g=>({...g,images:g.images||[]})),selectedspot:u,seleteddataforpriceupdate:n,setselectedSpot:d,selectedspotid:f,setselectedspotid:w})]}),l("div",{className:"px-3",children:[e("label",{htmlFor:"currentPrice",className:"text-black px-2",children:"Current Price"}),l("div",{className:"flex items-center rounded-lg px-4 py-2 bg-zinc-200",children:[e("span",{className:"text-gray-400 font-semibold text-xl",children:"$"}),e("input",{type:"number",className:"w-full h-10 text-xl font-semibold focus:outline-none bg-transparent text-zinc-600 border-none focus:ring-0",value:L||"",placeholder:"Price",readOnly:!0})]})]}),l("div",{className:"px-3",children:[e("label",{htmlFor:"nextPrice",className:"text-black px-2",children:"Next Price"}),l("div",{className:"flex items-center rounded-lg px-4 py-2 bg-zinc-200",children:[e("span",{className:"text-gray-400 font-semibold text-xl",children:"$"}),e("input",{type:"number",className:"w-full h-10 text-xl font-semibold focus:outline-none bg-transparent text-zinc-600 border-none focus:ring-0",value:h,onChange:g=>b(g.target.value),placeholder:"New Price"})]})]}),l("div",{className:"flex flex-col gap-4 px-4",children:[e("button",{type:"button",onClick:D,className:"w-full font-semibold bg-brand-primary rounded-full px-4 py-2 hover:bg-brand-primary-dark",disabled:v,children:"Adjust Price"}),e("button",{type:"button",className:"w-full border border-gray-300 rounded-full px-4 py-2 hover:bg-gray-100",onClick:()=>t(null),disabled:v,children:"Cancel"})]})]})}),l("div",{className:"flex-1 mt-8 md:mt-0 text-center",children:[e("h3",{className:"font-semibold mb-4",children:"These tips will help hosts with practical pricing strategies"}),l("ul",{className:"space-y-10 text-sm",children:[l("li",{children:[e("strong",{children:"Include Clean-Up Fees:"})," Add cleaning costs to your base price to cover post-booking clean-up."]}),l("li",{children:[e("strong",{children:"Adjust for Demand:"})," Charge more when demand is high on weekends and holidays."]}),l("li",{children:[e("strong",{children:"Offer Value Packages:"})," Include extra services like setup to make your spot more appealing at a slightly higher price."]})]})]})]})]})]})})};function de(){const[t,n]=s.useState(null),[i,o]=s.useState(0),m=[{name:"List Spots",view:"list-spots",component:()=>e(z,{setEditSpot:n})},{name:"Add Spot",view:"add-spot",component:()=>e(O,{})},{name:"Edit Spot",view:"edit-spot",component:()=>e(F,{spot:t})}][i];return s.useEffect(()=>{if(t=="add")return o(1);t&&o(2)},[t]),s.useEffect(()=>{i!=2&&n(null)},[i]),l(y,{children:[e("div",{className:"flex  justify-between mb-5 max-sm:mb-16",children:i===0?l(y,{children:[e("h1",{className:"md:text-2xl text-2xl font-semibold ml-3",children:"My Spots"}),e("button",{onClick:()=>o(1),className:"bg-brand-primary text-black px-6 py-2 rounded-md font-semibold",children:"Add Spot"})]}):l("button",{onClick:()=>o(0),className:"text-2xl lg:hidden md:hidden font-semibold flex max-sm:fixed max-sm:top-16 max-sm:w-screen z-50 bg-white items-center gap-3",children:[e($,{className:"bg-white"})," Back to Spots Page"]})}),e(M,{children:e(m.component,{})})]})}const z=({setEditSpot:t})=>{const{spots:n,isLoading:i}=A({draft:!1}),o=n.length===0,[r,m]=s.useState(null),[p,c]=s.useState(null);console.log({spots:n});const a=_(),u=async d=>{a.mutateAsync(d._id,{onSuccess:()=>{x.success("Spot deleted successfully")},onError:()=>{x.error("Failed to delete spot")}})};return l(y,{children:[r!==null&&e(q,{seleteddataforpriceupdate:r,setseleteddataforpriceupdate:m}),p!==null&&l("div",{className:"fixed w-screen top-0 left-0 h-screen bg-white/10 backdrop-blur-2xl z-[9999] flex justify-center items-center",children:[e("button",{onClick:()=>c(null),className:"top-10 right-10 absolute",children:e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",fill:"currentColor",children:e("path",{d:"M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM12 10.5858L9.17157 7.75736L7.75736 9.17157L10.5858 12L7.75736 14.8284L9.17157 16.2426L12 13.4142L14.8284 16.2426L16.2426 14.8284L13.4142 12L16.2426 9.17157L14.8284 7.75736L12 10.5858Z"})})}),e("div",{className:"bg-white h-fit w-fit rounded-xl",children:e(B,{spot:p,setselectedspotforreview:c})})]}),l("div",{className:"flex flex-col h-full",children:[o&&!i&&l("div",{className:"flex flex-col items-center justify-center h-full gap-3",children:[e("h1",{className:"text-2xl font-semibold",children:"No spot found"}),e("p",{className:"text-gray-500 text-center",children:"Ready to make second income ? List your spot now!"}),e("button",{onClick:()=>t("add"),className:"bg-brand-primary text-black px-6 py-2 rounded-md font-semibold",children:"Add Spot"})]}),e("div",{className:"grid gap-5",children:n.map(d=>e(y,{children:l(Z,{spot:d,onDelete:u,setseleteddataforpriceupdate:m,setselectedspotforreview:c,setEditSpot:t,children:[e("button",{onClick:()=>u(d),className:"text-gray-800 bg-gray-50 p-2 md:px-6 md:py-2 max-sm:my-4 rounded-md font-medium whitespace-nowrap border border-gray-300",children:"Delete"}),e("button",{onClick:()=>t(d),className:"bg-brand-primary text-black md:px-6 md:py-2 p-2  max-sm:my-4 rounded-md font-semibold mx-auto w-full",children:"Edit spot"})]},d._id)}))})]})]})};z.propTypes={setEditSpot:T.func.isRequired};export{de as default};
