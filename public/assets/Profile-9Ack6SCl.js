import{r as q,a0 as k,t as C,k as u,l as a,n as r,a5 as F,L as D,dh as M,ac as d,S as v,ad as s,F as E,Q as I,w as y}from"./index-CYYMkemY.js";import{u as R}from"./useUserDetails-DSAWxOWn.js";import{u as V}from"./useUserMutation-CqrPJWct.js";import{u as A}from"./useCart-BK-fuiiY.js";import"./SpotCard-DM2y568E.js";import{u as O}from"./useBooking-a8R0x6U_.js";import{u as K}from"./useCancelation-seRrv86D.js";import"./swiper-DX2zQgap.js";const Q={salutation:null,firstName:null,lastName:null,phone:null,address:null,state:null,zip:null,city:null,profilePic:null,document:null};function T(){const[l,i]=q.useState(Q),{refresh:P,auth:o}=k();K(),A();const[b,j]=q.useState(!1);O();const{updateUser:S}=V(),{data:h}=C({queryKey:["states"],queryFn:async()=>(await u.get("/chargeRate/states")).data,initialData:[]}),{data:e,refetch:U}=R(),{data:p}=C({queryKey:["cities",l.state],queryFn:async()=>(await u.get("/chargeRate/cities",{params:{state:l.state}})).data,initialData:[],enabled:!!l.state||!!(e!=null&&e.state)}),z=async t=>{const{data:c}=await u.patch("/userdetails",t);return await P(),U(),c};console.log("User:",l);const L=async t=>{t.preventDefault();const c=Object.entries(l).filter(([x,m])=>m!==null),g=Object.fromEntries(c);console.log(g),c.length!==0&&I.promise(async()=>{await z(g),await S({data:g}),f()},{success:"Profile updated successfully",pending:"Updating profile",error:{render:x=>{var m,N,w;return(w=(N=(m=x.data)==null?void 0:m.response)==null?void 0:N.data)==null?void 0:w.message}}})},f=()=>{j(()=>!b)};var n=(l==null?void 0:l.profilePic)??(o==null?void 0:o.profilePic);return typeof n=="string"&&(n=u.defaults.baseURL+"/auth/user/image/"+n),n instanceof File&&(n=URL.createObjectURL(n)),a(E,{children:b?r("div",{className:"flex max-sm:px-3 flex-row-reverse max-sm:flex-col sm:justify-between max-sm:items-center mt-9 w-full",children:[a("div",{}),r("form",{onSubmit:L,className:"flex flex-col gap-1 w-full",children:[a("div",{className:"flex justify-center",children:r("div",{className:"h-24 w-24 p-1 border- mr-4 bg-gray-300 rounded-full flex justify-center items-center relative",children:[r("label",{htmlFor:"profile-pic",className:"absolute bottom-0 right-0 bg-gray-200 rounded-full p-1 cursor-pointer flex justify-center items-center",title:"Change Profile Picture",children:[a("div",{className:"absolute bg-white p-2 rounded-full top-[85%] left-[30%]",children:a(M,{})}),n?a("img",{className:"w-full h-full rounded-full border-4 border-white",src:n,alt:"Profile Picture"}):a("div",{children:a(F,{className:"w-24 h-24 bg-gray-200 rounded-full"})})]}),a("input",{type:"file",id:"profile-pic",accept:"image/*",className:"hidden",onChange:t=>i({...l,profilePic:t.target.files[0]})})]})}),r("div",{className:"",children:[a(d,{htmlFor:"first-name",required:!0,children:"Name"}),r("div",{className:"grid sm:grid-cols-5 gap-2 max-w-xl",children:[a("div",{className:"col-span-1",children:r(v,{required:!0,value:l.salutation??(e==null?void 0:e.salutation),onChange:t=>i({...l,salutation:t.target.value}),id:"salutation",children:[a("option",{value:"",children:"Salutation"}),a("option",{value:"Mr",children:"Mr"}),a("option",{value:"Mrs",children:"Mrs"}),a("option",{value:"Miss",children:"Miss"})]})}),a("div",{className:"sm:col-span-2",children:a(s,{required:!0,value:l.firstName??(e==null?void 0:e.firstName),onChange:t=>i({...l,firstName:t.target.value}),name:"firstName",type:"text",id:"first-name",placeholder:"First Name"})}),a("div",{className:"sm:col-span-2",children:a(s,{value:l.lastName??(e==null?void 0:e.lastName),onChange:t=>i({...l,lastName:t.target.value}),name:"lastName",type:"text",id:"last-name",placeholder:"Last Name"})})]})]}),r("div",{className:"",children:[a(d,{htmlFor:"phone",required:!0,children:"Phone Number"}),a(s,{required:!0,placeholder:"1234567890",value:l.phone??(e==null?void 0:e.phone),onChange:t=>i({...l,phone:t.target.value}),defaultValue:e==null?void 0:e.phone,min:10,max:10,minLength:10,maxLength:10,name:"phone",type:"tel",id:"phone"})]}),r("div",{className:"",children:[a(d,{htmlFor:"email",required:!0,children:"Email ID"}),a(s,{placeholder:"Email ID",value:o==null?void 0:o.email,disabled:!0,defaultValue:e==null?void 0:e.emailId,name:"emailId",type:"text",id:"email"})]}),r("div",{children:[a(d,{htmlFor:"address",required:!0,children:"Address"}),a(s,{required:!0,placeholder:"Address",value:l.address??(e==null?void 0:e.address),onChange:t=>i({...l,address:t.target.value}),defaultValue:e==null?void 0:e.address,type:"text",id:"address"})]}),r("div",{children:[a(d,{htmlFor:"state",required:!0,children:"State"}),r(v,{id:"state",required:!0,value:l.state??(e==null?void 0:e.state),onChange:t=>i({...l,state:t.target.value}),children:[a("option",{value:"",children:"Select State"}),h==null?void 0:h.map(t=>a("option",{value:t,children:t},t))]})]}),r("div",{children:[a(d,{htmlFor:"zip",required:!0,children:"Zip"}),a(s,{required:!0,placeholder:"Zip",value:l.zip??(e==null?void 0:e.zip),onChange:t=>i({...l,zip:t.target.value}),defaultValue:e==null?void 0:e.zip,type:"text",id:"zip"})]}),r("div",{children:[a(d,{htmlFor:"document",required:!0,children:"Upload Document"}),a(s,{type:"file",id:"document",accept:"image/*",onChange:t=>i({...l,document:t.target.files[0]})})]}),r("div",{children:[a(d,{htmlFor:"city",className:"text-sm font-medium text-gray-600",required:!0,children:"City"}),r(v,{required:!0,value:l.city??(e==null?void 0:e.city),onChange:t=>i({...l,city:t.target.value}),id:"city",children:[a("option",{value:"",children:"Select City"}),p==null?void 0:p.map(t=>a("option",{value:t,children:t},t))]})]}),a("div",{className:"py-3 pl-7 -mx-5 md:bg-gray-200 bg-white backdrop-blur-sm  translate-y-5",children:r("div",{className:"gap-2 flex",children:[a("button",{type:"submit",className:"bg-brand-primary text-black px-6 py-2 rounded-md font-semibold",children:"Save"}),a("button",{onClick:()=>f(),type:"reset",className:" text-black px-6 py-2 rounded-md font-semibold border border-gray-400",children:"Cancel"})]})})]})]}):a("div",{children:a("div",{className:"mx-auto bg-white shadow-md rounded-lg overflow-hidden my-4 min-h-[70vh]",children:r("div",{className:"px-6 py-4",children:[r("div",{className:"flex items-center justify-between",children:[r("div",{className:"flex flex-col",children:[r("h2",{className:"font-bold text-lg",children:[l.salutation??(e==null?void 0:e.salutation)," ",l.firstName??(e==null?void 0:e.firstName)]}),a("p",{className:"text-gray-600",children:l.phone??(e==null?void 0:e.phone)}),a("p",{className:"text-gray-600",children:e==null?void 0:e.emailId}),a("p",{className:"text-gray-600",children:l.address??(e==null?void 0:e.address)})]}),a("div",{children:a("div",{className:"h-24 w-24 p-1 border- mr-4 bg-gray-300 rounded-full flex justify-center items-center relative",children:n?a("img",{className:"w-full h-full rounded-full border-4 border-white",src:n,alt:"Profile Picture"}):a("div",{children:a(F,{className:"w-24 h-24 bg-gray-200 rounded-full"})})})})]}),r("div",{className:"flex space-x-4 mt-4",children:[a("button",{onClick:()=>f(),className:"text-brand-primary font-semibold bg-zinc-100 px-2 text-lg rounded-md border-2 border-zinc-300",children:"edit"}),a(D,{to:"/user/default?view=settings",className:"bg-brand-primary font-semibold text-center px-2 text-lg rounded-md border-2 border-transparent",children:"Setting"})]})]})})})})}T.propTypes={user:y.object,login:y.func,onUpdate:y.func};export{T as default};
